AI销售助手功能需求文档 (销售状态驱动多Agent架构版 - 优化版)

  1. 核心目标

  专注知识付费/在线课程销售垂直场景，构建销售状态驱动的多Agent智能销售对话系统。采用"5个专业Agent + 能力层 + 成本优化Workflow"架构，通过对话管理Agent集成画像更新、专业分工协作、个性化推荐和智能促单策略，控制每轮对话LLM调用在2-3次以内，提升销售转化率和用户体验。预留TextGrad自优化模块用于后续持续改进。

  2. 核心用户流程 (成本优化多Agent协作模式)

  2.1 成本优化执行流程

  ```
  用户输入 → 对话管理Agent (单次LLM调用)
              ↓ (一次性完成多任务)
       上下文管理 + 意图识别 + 阶段判断 + 画像更新 + 路由决策
              ↓
         专业Agent (基于最新画像，单次LLM调用)
              ↓  
      对话管理Agent (模板整合或简单LLM调用)
              ↓
           回复用户
  
  LLM调用控制: 2-3次/轮对话
  ```

  2.2 详细流程说明

  1. 用户咨询接入 - 用户通过多渠道发起课程相关咨询
  2. 对话管理Agent多任务处理（单次LLM调用）：
     - 上下文管理：对话历史分析和状态跟踪
     - 意图识别：用户当前意图和需求变化识别
     - 阶段判断：基于上下文的销售阶段判断
     - 画像更新：增量提取用户特征，实时更新用户画像
     - 路由决策：选择最适合的专业Agent
  3. 专业Agent执行：基于最新用户画像，生成专业回复（单次LLM调用）
  4. 回复整合：对话管理Agent整合回复（优先使用模板，复杂情况调用LLM）
  5. 用户响应生成：生成个性化、专业化的最终回复
  6. 效果优化：预留TextGrad自优化模块，基于转化数据持续优化

  3. 主要功能清单 (5个专业Agent + 能力层设计)

  3.1 Agent层 (5个专业Agent，职责明确分工)

  3.1.1 对话管理Agent (核心控制中枢 + 画像更新)
  - 会话状态管理：维护多轮对话上下文和用户历史
  - 上下文智能分析：对话历史压缩和关键信息提取  
  - LLM意图识别：使用LLM进行复杂语义理解和意图分析
  - 销售阶段判断：智能识别当前销售阶段和用户状态
  - 实时用户画像更新：增量提取用户特征，与历史画像智能合并
  - 专业Agent路由：基于意图、阶段、上下文的综合路由决策
  - 回复统一整合：汇总专业Agent回复，生成一致性用户回复
  - 多轮对话维护：处理复杂对话逻辑和上下文传递

  3.1.2 需求发现Agent (需求挖掘阶段专家)
  - 深度需求理解：通过多轮提问明确用户真实学习目标
  - 用户痛点识别：挖掘用户当前遇到的问题和挑战
  - 学习动机分析：理解用户学习驱动力和期望收益
  - 预算时间评估：评估用户的投入预算和时间安排
  - 需求挖掘话术生成：生成引导性提问和深度挖掘话术

  3.1.3 课程推荐Agent (个性化推荐专家)
  - LLM个性化推荐：基于最新用户画像进行智能课程匹配
  - 推荐理由生成：为每个推荐课程生成个性化推荐理由
  - 课程优势包装：突出课程与用户需求的匹配点
  - 差异化对比：展示不同课程的区别和适用场景
  - 推荐展示话术：生成吸引人的课程介绍和展示话术

  3.1.4 异议处理Agent (异议消除专家)
  - 异议类型识别：智能识别价格、效果、时间、信任等异议类型
  - 针对性回应策略：为不同异议类型制定专门的回应策略
  - 证据收集整理：收集相关案例、数据、证明材料
  - 信任建立机制：通过专业性展示和社会证明建立信任
  - 异议处理话术：生成有说服力的异议回应话术

  3.1.5 促单成交Agent (成交促进专家)
  - 价格敏感度分析：基于用户画像分析价格接受度和支付能力
  - 心理动态判断：识别用户购买意愿和决策紧迫程度
  - 个性化优惠方案：智能生成限时优惠、分期付款、组合套餐等方案
  - 紧迫感营造：合理设置时间限制和稀缺性暗示
  - 促单成交话术：生成推动决策的成交引导话术

  3.2 能力层 (工具性服务，支持Agent智能决策)

  3.2.1 用户画像服务 (核心优化服务) **【重点升级】**
  - 结构化画像模型：基于Pydantic的严格数据模型定义
  - 对话管理Agent集成：支持单次LLM调用的增量更新
  - 数据质量保证：字段验证、一致性检查、异常数据修正
  - 置信度评分：为每个画像字段维护置信度分数和加权合并
  - 缓存优化：热点用户画像Redis缓存，快速访问
  - 画像完整度评估：监控画像数据完整性和质量指标

  3.2.2 数据能力服务
  - 数据库查询服务：课程信息、用户数据、历史记录的结构化查询
  - 行为统计服务：用户行为数据的统计分析和销售漏斗指标计算
  - 转化预测服务：基于历史数据和用户特征的购买概率计算

  3.2.3 搜索检索服务
  - RAG检索服务：复用现有的向量+关键词混合检索能力
  - 课程知识库：结构化课程信息的精确匹配和检索
  - 用户评价检索：相关课程的用户评价和案例检索
  - FAQ知识检索：常见问题和标准答案的快速检索

  3.2.4 优惠策略服务 (支持促单成交Agent)
  - 价格策略引擎：基于课程定价和市场策略的价格计算
  - 优惠规则管理：限时优惠、满减、分期付款等优惠规则配置
  - 用户权益计算：基于用户等级和历史消费的权益计算
  - 库存稀缺度：课程库存和报名人数的实时统计

  3.2.5 系统能力服务
  - 会话状态管理：基于Redis的对话状态存储和恢复
  - 消息队列服务：异步任务处理和Agent间事件通信
  - 缓存服务：热点数据缓存和性能优化
  - 通知推送服务：邮件、短信等多渠道消息发送

  3.3 TextGrad自优化模块 (最后开发阶段)

  - Agent效果评估：各Agent的决策准确率和话术转化率分析
  - 推荐质量监测：课程推荐的点击率、转化率和用户满意度
  - 优惠策略效果：不同优惠方案的成交率和利润率分析
  - Workflow流程优化：销售流程的瓶颈识别和路径优化
  - 持续学习机制：基于用户反馈的Agent参数自动调优

  4. 销售意图理解 (LLM实现，集成在对话管理Agent)

  替换现有基于规则的NLU引擎，使用LLM进行更精准的语义理解：
  - 复杂语义场景处理：支持一句话多意图、隐含意图识别
  - 结构化输出：返回JSON格式的意图、置信度、实体、销售阶段信息
  - 上下文理解：结合对话历史进行意图判断和阶段识别
  - 销售状态路由：准确识别当前销售阶段并路由到对应专业Agent

  5. 实时用户画像更新 (对话管理Agent集成实现) **【成本优化版】**

  ### 5.1 集成式画像更新设计
  - **多任务单次LLM调用**：意图识别+阶段判断+画像更新+路由决策
  - **成本控制**：每轮对话LLM调用控制在2-3次以内
  - **上下文感知更新**：基于完整对话历史的画像更新

  ### 5.2 增量更新策略
  - **智能对比**：与历史画像对比，仅更新有变化的字段
  - **置信度加权**：新信息与历史信息按置信度加权合并
  - **数据验证**：结构化输出验证，确保数据格式和逻辑一致性

  ### 5.3 性能优化
  - **缓存策略**：热点用户画像Redis缓存
  - **批处理优化**：非紧急更新异步批处理
  - **压缩上下文**：对话历史智能压缩，减少token消耗
  - **模板优先**：简单场景使用模板而非LLM

  课程推荐Agent使用LLM进行智能个性化推荐：
  - 语义理解用户需求：理解模糊、复杂的学习目标描述
  - 多维度匹配分析：综合考虑技能水平、时间预算、职业规划等因素
  - 动态推荐调整：根据用户反馈实时调整推荐策略
  - 个性化理由生成：为每个推荐生成个性化的推荐理由和卖点

  6. 智能话术生成 (各专业Agent直接实现)

  每个专业Agent都具备对应场景的话术生成能力：
  - 需求发现Agent：生成引导性提问和需求挖掘话术
  - 课程推荐Agent：生成课程介绍和推荐展示话术
  - 异议处理Agent：生成针对性异议回应和信任建立话术
  - 促单成交Agent：生成优惠介绍和成交引导话术

  7. 促单成交优惠策略 (促单成交Agent专业功能)

  促单成交Agent的核心创新功能：
  - 用户支付能力评估：基于对话信息和用户画像评估价格承受力
  - 购买意愿强度分析：识别用户的购买紧迫程度和决策阶段
  - 智能优惠方案生成：动态生成个性化优惠方案（限时折扣、分期付款、组合优惠等）
  - 紧迫感和稀缺性营造：合理设置时间限制和稀缺性提示

  8. 多轮对话管理 (对话管理Agent核心功能)

  维护完整的对话上下文，支持多轮深度交互：
  - 会话状态持久化：支持中断恢复和长时间对话
  - 上下文压缩机制：处理超长对话的上下文管理
  - 销售阶段跟踪：智能识别和跟踪销售流程进展
  - Agent间状态传递：确保各Agent获得完整上下文信息

  9. 验收标准

  9.1 销售意图理解 (对话管理Agent)

  完成该功能的标志是AI能够在3轮对话内准确识别用户的学习目标、预算范围、时间安排等核心需求，意图识别准确率达到85%以上，销售阶段路由准确率达到90%以上。

  9.2 个性化课程推荐 (课程推荐Agent)

  完成该功能的标志是系统能够基于用户画像从课程库中推荐出3-5个匹配度最高的课程，推荐相关性评分达到4.0/5.0以上，推荐理由个性化程度用户满意度达到80%以上。

  9.3 智能话术生成 (各专业Agent)

  完成该功能的标志是各Agent能够根据不同销售阶段和用户类型生成个性化话术，话术转化效果比标准话术提升20%以上，话术自然度和说服力评分达到4.2/5.0以上。

  9.4 促单成交优惠策略 (促单成交Agent)

  完成该功能的标志是系统能够智能判断用户价格敏感度并生成个性化优惠方案，成交转化率比固定优惠策略提升30%以上，优惠方案接受率达到60%以上。

  9.5 多轮对话管理 (对话管理Agent)

  完成该功能的标志是系统支持连续20轮以上的对话交互，能准确维护上下文信息和销售状态跟踪，对话连贯性评分达到4.5/5.0以上。

  9.6 整体系统性能

  完成该功能的标志是5个Agent协作的端到端销售流程，从需求发现到促单成交的完整转化率达到现有系统的150%以上，平均对话轮数控制在15轮以内，用户满意度达到4.3/5.0以上。